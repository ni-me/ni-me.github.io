<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>kaggle入门竞赛-数字识别 | CodeTrainer</title><meta name="description" content="kaggle入门竞赛-数字识别"><meta name="keywords" content="机器学习"><meta name="author" content="大巴斯基"><meta name="copyright" content="大巴斯基"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon1.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><meta name="twitter:card" content="summary"><meta name="twitter:title" content="kaggle入门竞赛-数字识别"><meta name="twitter:description" content="kaggle入门竞赛-数字识别"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png"><meta property="og:type" content="article"><meta property="og:title" content="kaggle入门竞赛-数字识别"><meta property="og:url" content="http://nieblog.me/2020/03/07/digit-recognizer/"><meta property="og:site_name" content="CodeTrainer"><meta property="og:description" content="kaggle入门竞赛-数字识别"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="http://nieblog.me/2020/03/07/digit-recognizer/"><link rel="prev" title="kaggle入门竞赛-泰坦尼克号" href="http://nieblog.me/2020/03/07/titanic/"><link rel="next" title="Coursera-机器学习-吴恩达-ex8" href="http://nieblog.me/2020/01/18/ml_ex8/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: false,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script></head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">CodeTrainer</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div></div></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">23</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">6</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#比赛说明"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text"> 比赛说明</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#一-数据分析"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text"> 一、数据分析</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#数据下载"><span class="toc_mobile_items-number">2.1.</span> <span class="toc_mobile_items-text"> 数据下载</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#二-降维处理"><span class="toc_mobile_items-number">3.</span> <span class="toc_mobile_items-text"> 二、降维处理</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#三-模型选择"><span class="toc_mobile_items-number">4.</span> <span class="toc_mobile_items-text"> 三、模型选择</span></a></li></ol></div></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#比赛说明"><span class="toc-number">1.</span> <span class="toc-text"> 比赛说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#一-数据分析"><span class="toc-number">2.</span> <span class="toc-text"> 一、数据分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#数据下载"><span class="toc-number">2.1.</span> <span class="toc-text"> 数据下载</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二-降维处理"><span class="toc-number">3.</span> <span class="toc-text"> 二、降维处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三-模型选择"><span class="toc-number">4.</span> <span class="toc-text"> 三、模型选择</span></a></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png)"><div id="post-info"><div id="post-title"><div class="posttitle">kaggle入门竞赛-数字识别</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 发表于 2020-03-07<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> 更新于 2020-03-07</time><div class="post-meta-wordcount"><div class="post-meta-pv-cv"></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h2 id="比赛说明"><a class="markdownIt-Anchor" href="#比赛说明"></a> 比赛说明</h2>
<p><a href="https://github.com/ni-me/kaggle-getting-started/tree/master/digit-recognizer" target="_blank" rel="noopener">完整代码</a></p>
<blockquote>
<p>MNIST (“Modified National Institute of Standards and Technology”) is the de facto “hello world” dataset of computer vision. Since its release in 1999, this classic dataset of handwritten images has served as the basis for benchmarking classification algorithms. As new machine learning techniques emerge, MNIST remains a reliable resource for researchers and learners alike.</p>
<p>In this competition, your goal is to correctly identify digits from a dataset of tens of thousands of handwritten images. We’ve curated a set of tutorial-style kernels which cover everything from regression to neural networks. We encourage you to experiment with different algorithms to learn first-hand what works well and how techniques compare.</p>
</blockquote>
<h2 id="一-数据分析"><a class="markdownIt-Anchor" href="#一-数据分析"></a> 一、数据分析</h2>
<h3 id="数据下载"><a class="markdownIt-Anchor" href="#数据下载"></a> 数据下载</h3>
<ul>
<li>
<p><a href="https://www.kaggle.com/c/digit-recognizer/data" target="_blank" rel="noopener">数据下载</a></p>
</li>
<li>
<p>读取数据</p>
</li>
</ul>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">open_csv</span><span class="params">()</span>:</span></div><div class="line">    path = os.path.abspath(<span class="string">'.'</span>)</div><div class="line">    data = pd.read_csv(os.path.join(path, <span class="string">'data/train.csv'</span>))</div><div class="line">    data1 = pd.read_csv(os.path.join(path, <span class="string">'data/test.csv'</span>))</div><div class="line"></div><div class="line">    train_data = data.values[<span class="number">0</span>:, <span class="number">1</span>:]</div><div class="line">    train_label = data.values[<span class="number">0</span>:, <span class="number">0</span>]</div><div class="line">    test_data = data1.values[<span class="number">0</span>:, <span class="number">0</span>:]</div><div class="line"></div><div class="line">    <span class="keyword">return</span> train_data, train_label, test_data</div></pre></td></tr></table></figure></div>
<h2 id="二-降维处理"><a class="markdownIt-Anchor" href="#二-降维处理"></a> 二、降维处理</h2>
<p>为了加快模型的训练，我们可以用PCA对数据进行降维处理：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dRPCA</span><span class="params">(train_data, test_data, COMPONENT_NUM)</span>:</span></div><div class="line">    print(<span class="string">'dimensionality reduction...'</span>)</div><div class="line">    trainData = np.array(train_data)</div><div class="line">    testData = np.array(test_data)</div><div class="line"></div><div class="line">    pca = PCA(n_components=COMPONENT_NUM, whiten=<span class="keyword">False</span>)</div><div class="line">    pca.fit(trainData)</div><div class="line">    pcaTrainData = pca.transform(trainData)</div><div class="line">    pcaTestData = pca.transform(testData)</div><div class="line"></div><div class="line">    print(<span class="string">'特征数量: %s'</span> % pca.n_components_)</div><div class="line">    print(<span class="string">'总方差占比: %s'</span> % sum(pca.explained_variance_ratio_))</div><div class="line"></div><div class="line">    <span class="keyword">return</span> pcaTrainData, pcaTestData</div></pre></td></tr></table></figure></div>
<h2 id="三-模型选择"><a class="markdownIt-Anchor" href="#三-模型选择"></a> 三、模型选择</h2>
<p>根据目标函数确定学习类型：监督学习、分类问题。</p>
<ul>
<li>分类问题：0~9数字</li>
<li>常用算法：：knn、决策树、朴素贝叶斯、Logistic回归、SVM、集成方法（随机森林和 AdaBoost）</li>
</ul>
<p>这里我们使用SVM进行训练：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="string">'''</span></div><div class="line"><span class="string">param_grid = &#123;'C' : [1, 10, 100],</span></div><div class="line"><span class="string">              'gamma' : [0.1, 1, 10]&#125;</span></div><div class="line"><span class="string">grid_search = GridSearchCV(SVC(), param_grid=param_grid, cv=2, n_jobs=-1)</span></div><div class="line"><span class="string">grid_search.fit(train_data_pca, train_label)</span></div><div class="line"><span class="string">predict_label = grid_search.predict(test_data_pca)</span></div><div class="line"><span class="string">print(predict_label[1:20])</span></div><div class="line"><span class="string">print('best parameters: %s' % grid_search.best_params_)</span></div><div class="line"><span class="string">print('Best score: %s' % grid_search.best_score_)</span></div><div class="line"><span class="string">'''</span></div><div class="line">svc = SVC(C=<span class="number">10</span>)</div><div class="line">svc.fit(train_data_pca, train_label)</div></pre></td></tr></table></figure></div>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">大巴斯基</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://nieblog.me/2020/03/07/digit-recognizer/">http://nieblog.me/2020/03/07/digit-recognizer/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://nieblog.me">CodeTrainer</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/机器学习/">机器学习    </a></div><div class="post_share"></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/03/07/titanic/"><img class="prev_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>kaggle入门竞赛-泰坦尼克号</span></div></a></div><div class="next-post pull_right"><a href="/2020/01/18/ml_ex8/"><img class="next_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>Coursera-机器学习-吴恩达-ex8</span></div></a></div></nav></div></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2017 - 2020 By 大巴斯基</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script id="ribbon" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/canvas-ribbon.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="ture"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>